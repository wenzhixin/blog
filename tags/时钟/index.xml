<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>时钟 on 文翼的博客</title>
    <link>http://blog.wenzhixin.net.cn/tags/%E6%97%B6%E9%92%9F/</link>
    <description>Recent content in 时钟 on 文翼的博客</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <copyright>wenzhixin.net.cn 粤ICP备15117953号</copyright>
    <lastBuildDate>Wed, 20 Nov 2013 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://blog.wenzhixin.net.cn/tags/%E6%97%B6%E9%92%9F/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>使用 canvas 绘制时钟</title>
      <link>http://blog.wenzhixin.net.cn/2013/11/20/canvas_draw_clock</link>
      <pubDate>Wed, 20 Nov 2013 00:00:00 +0000</pubDate>
      
      <guid>http://blog.wenzhixin.net.cn/2013/11/20/canvas_draw_clock</guid>
      <description>

&lt;p&gt;今天我们利用 canvas 来画一个基本的时钟程序。通过一边实践一边学习新的知识。&lt;/p&gt;

&lt;p&gt;准备工作，我们先定义需要用到的变量：&lt;/p&gt;
&lt;canvas id=&#34;canvas&#34; width=&#34;300&#34; height=&#34;300&#34;&gt;&lt;/canvas&gt;
&lt;script src=&#34;clock.js&#34;&gt;&lt;/script&gt;
var canvas = document.getElementById(&#39;canvas&#39;),
	context = canvas.getContext(&#39;2d&#39;),

	WIDTH = canvas.width,
	HEIGHT = canvas.height,
	RADIUS = WIDTH / 2 - 30;
	NUMBER_RADIUS = RADIUS + 10,
	FONT_HEIGHT = 15;

context.font = FONT_HEIGHT + &#39;px&#39;;

&lt;h4 id=&#34;1-画圆:033e0261394abe076a41319978c9c005&#34;&gt;1. 画圆&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;API：&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;beginPath()：起始一条路径，或重置当前路径&lt;/li&gt;
&lt;li&gt;arc(): 创建弧/曲线（用于创建圆或部分圆）&lt;/li&gt;
&lt;li&gt;stroke()：绘制已定义的路径&lt;/li&gt;
&lt;li&gt;fill()：填充当前绘图（路径）&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;JavaScript 语法：&lt;/strong&gt;&lt;/p&gt;
context.arc(x, y, r, sAngle, eAngle, counterclockwise);

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;参数&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;x&lt;/td&gt;
&lt;td&gt;圆的中心的 x 坐标。&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;y&lt;/td&gt;
&lt;td&gt;圆的中心的 y 坐标。&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;r&lt;/td&gt;
&lt;td&gt;圆的半径。&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;sAngle&lt;/td&gt;
&lt;td&gt;起始角，以弧度计。（弧的圆形的三点钟位置是 0 度）。&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;eAngle&lt;/td&gt;
&lt;td&gt;结束角，以弧度计。&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;counterclockwise&lt;/td&gt;
&lt;td&gt;可选。规定应该逆时针还是顺时针绘图。False = 顺时针，true = 逆时针。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;关键代码：&lt;/strong&gt;&lt;/p&gt;
function drawCircle() {
	context.beginPath();
	context.arc(canvas.width / 2, canvas.height / 2, RADIUS, 0, Math.PI * 2, true);
	context.stroke();
}

function drawCenter() {
	context.beginPath();
	context.arc(WIDTH / 2, HEIGHT / 2, 5, 0, Math.PI * 2, true);
	context.fill();
}

&lt;p&gt;&lt;img src=&#34;http://blog.wenzhixin.net.cn/2013/11/20/1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;2-画数字:033e0261394abe076a41319978c9c005&#34;&gt;2. 画数字&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;API：&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;measureText()：返回包含指定文本宽度的对象&lt;/li&gt;
&lt;li&gt;fillText()：在画布上绘制“被填充的”文本&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;JavaScript 语法：&lt;/strong&gt;&lt;/p&gt;
context.fillText(text,x,y,maxWidth);

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;参数&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;text&lt;/td&gt;
&lt;td&gt;规定在画布上输出的文本。&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;x&lt;/td&gt;
&lt;td&gt;开始绘制文本的 x 坐标位置（相对于画布）。&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;y&lt;/td&gt;
&lt;td&gt;开始绘制文本的 y 坐标位置（相对于画布）。&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;maxWidth&lt;/td&gt;
&lt;td&gt;可选。允许的最大文本宽度，以像素计。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;关键代码：&lt;/strong&gt;&lt;/p&gt;
function drawNumbers() {
	var i, angle, numWidth;

	for (i = 1; i &lt;= 12; i++) {
		angle = Math.PI / 6 * (i - 3);
		numWidth = context.measureText(i).width;
		context.fillText(i, WIDTH / 2 + Math.cos(angle) * NUMBER_RADIUS - numWidth / 2,
			HEIGHT / 2 + Math.sin(angle) * NUMBER_RADIUS + FONT_HEIGHT / 3);
	}
}

&lt;p&gt;&lt;img src=&#34;http://blog.wenzhixin.net.cn/2013/11/20/2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;3-画指针:033e0261394abe076a41319978c9c005&#34;&gt;3. 画指针&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;API：&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;moveTo()：把路径移动到画布中的指定点，不创建线条&lt;/li&gt;
&lt;li&gt;lineTo()：添加一个新点，然后在画布中创建从该点到最后指定点的线条&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;关键代码：&lt;/strong&gt;&lt;/p&gt;
function drawHands() {
	var date = new Date(),
		h = date.getHours(),
		m = date.getMinutes(),
		s = date.getSeconds();

	drawHand((h % 12) * 5 + (m / 60) * 5, RADIUS - 60);
	drawHand(m, RADIUS - 40);
	drawHand(s, RADIUS - 20);
}

function drawHand(loc, radius) {
	var angle = Math.PI * 2 * (loc / 60) - Math.PI / 2;

	context.moveTo(WIDTH / 2, HEIGHT / 2);
	context.lineTo(WIDTH / 2 + Math.cos(angle) * radius,
		HEIGHT / 2 + Math.sin(angle) * radius);
	context.stroke();
}

&lt;p&gt;&lt;img src=&#34;http://blog.wenzhixin.net.cn/2013/11/20/3.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;4-加上计时器:033e0261394abe076a41319978c9c005&#34;&gt;4. 加上计时器&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;API：&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;clearRect()：在给定的矩形内清除指定的像素&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;关键代码：&lt;/strong&gt;&lt;/p&gt;
function drawClock() {
	context.clearRect(0, 0, WIDTH, HEIGHT);

	drawCircle();
	drawCenter();
	drawNumbers();
	drawHands();
	setTimeout(drawClock, 1000);
}

drawClock();

&lt;p&gt;到此，大功告成！查看 &lt;a href=&#34;http://blog.wenzhixin.net.cn/demos/canvas/clock.html&#34;&gt;demo&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>