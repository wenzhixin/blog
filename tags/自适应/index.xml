<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>自适应 on 文翼的博客</title>
    <link>http://blog.wenzhixin.net.cn/tags/%E8%87%AA%E9%80%82%E5%BA%94/</link>
    <description>Recent content in 自适应 on 文翼的博客</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <copyright>wenzhixin.net.cn 粤ICP备15117953号</copyright>
    <atom:link href="http://blog.wenzhixin.net.cn/tags/%E8%87%AA%E9%80%82%E5%BA%94/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>让你的网站支持自适应界面</title>
      <link>http://blog.wenzhixin.net.cn/1/01/01/responsive_web</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://blog.wenzhixin.net.cn/1/01/01/responsive_web</guid>
      <description>

&lt;h4 id=&#34;1-介绍:be5e1839066e83ead1c56c385e620bf2&#34;&gt;1. 介绍&lt;/h4&gt;

&lt;p&gt;随着智能手机的普及，越来越多的人使用手机上网。
我自己就是，经常懒得开电脑，直接用手机查看网页，简单又方便。
那么，如何才能把自己的博客做成在不同大小的设备上呈现同样的界面？&lt;/p&gt;

&lt;h4 id=&#34;2-如何做:be5e1839066e83ead1c56c385e620bf2&#34;&gt;2. 如何做&lt;/h4&gt;

&lt;p&gt;1) 在网页代码的头部，加入 viewport 元标签&lt;/p&gt;
&lt;meta name=&#34;viewport&#34; content=&#34;width=device-width; initial-scale=1.0&#34; /&gt;

&lt;p&gt;viewport 是页面默认的宽度和高度，上面代码的意思是：
页面宽度默认等于屏幕宽度（width=device-width），
并且原始缩放比例（initial-scale=1.0）为1.0，即页面初始大小占屏幕面积的100%。&lt;/p&gt;

&lt;p&gt;这样，我们在手机上查看就可以看到整个页面的大小了。&lt;/p&gt;

&lt;p&gt;2) 设置 CSS 的 @media 规则&lt;/p&gt;

&lt;p&gt;在同一个CSS文件中，可以根据不同的屏幕分辨率，选择应用不同的CSS规则。&lt;/p&gt;

&lt;p&gt;例如：&lt;/p&gt;
@media (min-width: 768px) and (max-width: 979px) {
    /* CSS1 */
}

@media (max-width: 767px) {
    /* CSS2 */
}

&lt;p&gt;分别表示屏幕在 768px-979px 之间显示 CSS1 内容 和 屏幕宽度小于 767 像素显示 CSS2 内容。&lt;/p&gt;

&lt;p&gt;由于博客用到了 bootstrap，所以我引入了 bootstrap-responsive.css 样式，它已经帮我做了大部分工作了。&lt;/p&gt;

&lt;p&gt;3) 加入自定义样式&lt;/p&gt;
@media (max-width: 767px) {
    body {
        padding-left: 0px;
        padding-right: 0px;
    }
    .header_content {
          padding-left: 10px;
    }
    .fork_me, .header_top, .wenyi-logo, .weibo_content, #bdshare, .bulletin {
          display: none;
    }
    .post_content {
        padding: 10px;
    }
}

&lt;p&gt;这段代码的意思是，如果屏幕宽度小于 767 像素，那么 body 的左右间距都为 0，博客的标题和文章的间距为 10 像素，
并且隐藏 fork me 图片、标题图片、博客的 logo、微博、百度分享和公告功能。&lt;/p&gt;

&lt;p&gt;这样，我们在手机上查看就可以看到我们自己想要的内容了。&lt;/p&gt;

&lt;p&gt;4) 设置 js 代码&lt;/p&gt;

&lt;p&gt;由于“返回顶部”按钮在电脑以及手机上的显示位置不同，所以无法用css来进行设置（知道的人麻烦告诉我下），
所以只能用 js 来进行设置，代码如下：&lt;/p&gt;
$(window).resize(showGotoTop);

function showGotoTop() {
    if ($(window).width() &gt; 767) {
        $gotoTop.css({
            &#39;left&#39;: &#39;50%&#39;,
            &#39;margin-left&#39;: $(&#39;.posts&#39;).width() / 2 + &#39;px&#39;,
            &#39;right&#39;: &#39;auto&#39;
        });
    } else {
        $gotoTop.css({
            &#39;left&#39;: &#39;auto&#39;,
            &#39;margin-left&#39;: &#39;0&#39;,
            &#39;right&#39;: &#39;0&#39;
        });
    }
}

&lt;p&gt;代码监听了界面改变大小时的事件，并且计算出“返回顶部”的位置。&lt;/p&gt;

&lt;h4 id=&#34;3-其他问题:be5e1839066e83ead1c56c385e620bf2&#34;&gt;3. 其他问题&lt;/h4&gt;

&lt;p&gt;由于 IE6-8 等浏览器不支持 CSS3 Media，这里推荐使用 github 上的开源项目 &lt;a href=&#34;https://github.com/scottjehl/Respond&#34;&gt;Respond.js&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;Respond.js 是一个快速、轻量的 polyfill，用于为 IE6-8 以及其它不支持 CSS3 Media Queries 的浏览器提供媒体查询的 min-width 和 max-width 特性，实现响应式网页设计（Responsive Web Design）。&lt;/p&gt;

&lt;p&gt;使用：&lt;/p&gt;
&lt;!--[if lt IE 9]&gt;
    &lt;script src=&#34;respond.js&#34;&gt;&lt;/script&gt;
&lt;![endif]--&gt;
</description>
    </item>
    
    <item>
      <title>设置 viewport 实现定宽网页 WebApp 下布局自适应</title>
      <link>http://blog.wenzhixin.net.cn/1/01/01/viewport_mobile</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://blog.wenzhixin.net.cn/1/01/01/viewport_mobile</guid>
      <description>&lt;p&gt;一般来说，我们实现布局自适应可以有以下几种方式：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;使用流动布局（fluid grid）&lt;/li&gt;
&lt;li&gt;根据屏幕大小选择加载不同的CSS&lt;/li&gt;
&lt;li&gt;使用 CSS 的@media规则&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;详细的介绍，可以参考&lt;a href=&#34;http://www.ruanyifeng.com/blog/2012/05/responsive_web_design.html&#34;&gt;自适应网页设计（Responsive Web Design）&lt;/a&gt;这篇文章。&lt;/p&gt;

&lt;p&gt;这里介绍的是如何让定宽网页在 WebApp 下（或者手机浏览器）实现自适应。例如，我们设计了一套宽度为 640px 的小页面，主要是用于手机查看，但是手机屏幕分辨率实在太多了，要适应每台手机，应该怎么办呢？&lt;/p&gt;

&lt;p&gt;首先，我们在 head 中加入：&lt;/p&gt;
&lt;head&gt;
&lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, user-scalable=no&#34;&gt;
&lt;/head&gt;

&lt;p&gt;这里表示 viewport 的宽度为匹配设备屏幕的宽度，且禁用缩放。涉及到两个概念：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.mozilla.org/zh-CN/docs/Mobile/Viewport_meta_tag&#34;&gt;viewport 元素&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;devicePixelRatio：设备上物理像素和设备独立像素(device-independent pixels (dips))的比例。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;由于 iphone 手机和 android 4.0 以上的手机支持修改 viewport 的 width 来改变页面的缩放情况，因此我们&lt;strong&gt;可以将 width 指定为页面设计的宽度&lt;/strong&gt;，如此一来，你的页面正好充满 viewport 并全屏显示，而不会缩放。例如：&lt;/p&gt;
&lt;meta name=&#34;viewport&#34; content=&#34;width=640px, user-scalable=no&#34;&gt;

&lt;p&gt;但是对于 android 4.0 以下的手机，不支持设置 viewport 的 width，但是我们&lt;strong&gt;可以设置 Android 的另一参数target-densitydpi，从而达到相同的目的&lt;/strong&gt;，计算 target-densitydpi 的公式如下：&lt;/p&gt;
target-densitydpi = UI-width / device-width * window.devicePixelRatio * 160;
  //UI-width ：WebApp布局宽度
  //device-width ：屏幕分辨率宽度

&lt;p&gt;于是，&lt;strong&gt;最终解决方案&lt;/strong&gt;如下：&lt;/p&gt;
&lt;meta name=&#34;viewport&#34; content=&#34;target-densitydpi=device-dpi, width=640px, user-scalable=no&#34;&gt;
$(function () {
	var DEFAULT_WIDTH = 640, // 页面的默认宽度
		ua = navigator.userAgent.toLowerCase(), // 根据 user agent 的信息获取浏览器信息
		deviceWidth = window.screen.width, // 设备的宽度
		devicePixelRatio = window.devicePixelRatio || 1, // 物理像素和设备独立像素的比例，默认为1
		targetDensitydpi;

	// Android4.0以下手机不支持viewport的width，需要设置target-densitydpi
	if (ua.indexOf(&#34;android&#34;) !== -1 &amp;&amp; parseFloat(ua.slice(ua.indexOf(&#34;android&#34;)+8)) &lt; 4) {
    	targetDensitydpi = DEFAULT_WIDTH / deviceWidth * devicePixelRatio * 160;
    	$(&#39;meta[name=&#34;viewport&#34;]&#39;).attr(&#39;content&#39;, &#39;target-densitydpi=&#39; + targetDensitydpi +
    			&#39;, width=device-width, user-scalable=no&#39;);
    }

	// TODO: 其他手机需要特殊处理的在下面
});

&lt;p&gt;&lt;strong&gt;存在的问题&lt;/strong&gt;：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;目前只测试 android 和 ios/ipad 手机&lt;/li&gt;
&lt;li&gt;android 下使用 firefox 无法检测出 android 的版本，因此只能忽略 firefox&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
&lt;p&gt;ps: 理论上可以利用枚举的方式将通用的手机分辨率记录起来，从而达到适应所有机型的效果。&lt;/p&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
  </channel>
</rss>