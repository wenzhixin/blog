<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>本地时间 on 文翼的博客</title>
    <link>http://blog.wenzhixin.net.cn/tags/%E6%9C%AC%E5%9C%B0%E6%97%B6%E9%97%B4/</link>
    <description>Recent content in 本地时间 on 文翼的博客</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <copyright>wenzhixin.net.cn 粤ICP备15117953号</copyright>
    <lastBuildDate>Tue, 05 Nov 2013 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://blog.wenzhixin.net.cn/tags/%E6%9C%AC%E5%9C%B0%E6%97%B6%E9%97%B4/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>将本地时间转换为 GMT 时间</title>
      <link>http://blog.wenzhixin.net.cn/2013/11/05/local_time_to_timezone</link>
      <pubDate>Tue, 05 Nov 2013 00:00:00 +0000</pubDate>
      
      <guid>http://blog.wenzhixin.net.cn/2013/11/05/local_time_to_timezone</guid>
      <description>

&lt;p&gt;在写 RSS 订阅接口的时候，发现最终输出文章的 RSS 时间（GMT时间），在本地上显示的时间和在服务器上显示的时间不一致。
原因是时区不一致，那么在 JavaScript 中，如何将时间转换为统一的时间呢？&lt;/p&gt;

&lt;h4 id=&#34;1-查看本地和服务器的时区:ce6487b43f796a5886a1d742dcbe5740&#34;&gt;1. 查看本地和服务器的时区&lt;/h4&gt;

&lt;p&gt;通过 date 命令，可以知道：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;本地的时区是：GMT+0800 (CST)&lt;/li&gt;
&lt;li&gt;服务器的时区是：GMT+0400 (MSK)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;首先，需要明确的一点是，文章上的时间是基于本地时间的，也就是说是 GMT+0800 (CST)。&lt;/p&gt;

&lt;h4 id=&#34;2-代码调试:ce6487b43f796a5886a1d742dcbe5740&#34;&gt;2. 代码调试&lt;/h4&gt;

&lt;p&gt;便于理解，我们来举个栗子，例如文章的时间为 2013-11-05 00:00:00，
那么我们最终想要的时间是 2013-11-04 16:00:00 GMT&lt;/p&gt;

&lt;p&gt;在本机上&lt;/p&gt;
var date = new Date(&#39;2013-11-05 00:00:00&#39;); // Tue Nov 05 2013 00:00:00 GMT+0800 (CST)
date.toGMTString(); // Mon, 04 Nov 2013 16:00:00 GMT

&lt;p&gt;在服务器上：&lt;/p&gt;
var date = new Date(&#39;2013-11-05 00:00:00&#39;); // Tue Nov 05 2013 00:00:00 GMT+0400 (MSK)
date.toGMTString(); // Mon, 04 Nov 2013 20:00:00 GMT

&lt;p&gt;通过对比可以看到，在服务器上也把需要转换的时间当初是本地时间了，所以导致了最终转换的 GMT 时间不一致。&lt;/p&gt;

&lt;h4 id=&#34;3-如何解决:ce6487b43f796a5886a1d742dcbe5740&#34;&gt;3. 如何解决&lt;/h4&gt;

&lt;p&gt;Date 对象中有 getTimezoneOffset() 方法，返回的是本地时间与 GMT 时间或 UTC 时间之间相差的分钟数。&lt;/p&gt;
var date = new Date(&#39;2013-11-05 00:00:00&#39;); // Tue Nov 05 2013 00:00:00 GMT+0400 (MSK)

var localTime = date.getTime() - 8 * 3600000 - date.getTimezoneOffset() * 60000; // 先将文章的时间转换为服务器的本地时间

var newDate = new Date(localTime); // Mon Nov 04 2013 20:00:00 GMT+0400 (MSK)

newDate.toGMTString(); // Mon, 04 Nov 2013 16:00:00 GMT

&lt;p&gt;可以看到，在服务器上也得到我们想要的结果了。&lt;/p&gt;

&lt;h4 id=&#34;4-最终成果:ce6487b43f796a5886a1d742dcbe5740&#34;&gt;4. 最终成果&lt;/h4&gt;
function getGMTString(time, localTimezone) {
    var date = new Date(time);
    return new Date(date.getTime() - localTime * 3600000 -
        date.getTimezoneOffset() * 60000).toGMTString();
}
</description>
    </item>
    
  </channel>
</rss>